<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="ISO-8859-1">
  <title>CfhAllPosts</title>
  <link rel="icon" type="image/x-icon" href="../public/img/favicon.png" th:href="@{/img/favicon.png}">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="../public/css/styles.css" th:href="@{/css/styles.css}">
  <script src="../public/js/jquery-3.6.0.js" th:src="@{/js/jquery-3.6.0.js}"></script>
  <script src="../public/js/blog-scripts.js" th:src="@{/js/blog-scripts.js}"></script>
</head>

<body>
  <!-- create navigation bar ( header) -->
  <nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar"
          aria-expanded="false" aria-controls="navbar">
          <span class="sr-only"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span
            class="icon-bar"></span>
        </button>
        <a>
          <img src="../public/img/site-logo_white.png" th:src="@{/img/site-logo_white.png}" id="siteLogo" />
        </a>
      </div>
      <div id="navbar" class="collapse navbar-collapse">
        <ul class="nav navbar-nav">
          <li sec:authorize="isAuthenticated()"><a th:href="@{/}">Home</a></li>
          <li><a th:href="@{/login}">Login</a></li>
          <li><a th:href="@{/registration}">Register</a></li>
          <li sec:authorize="isAuthenticated()"><a th:href="@{/view_posts}">Posts</a></li>
          <li sec:authorize="isAuthenticated()"><a th:href="@{/post/new}">Create Post</a></li>
          <li sec:authorize="isAuthenticated()"><a th:href="@{/}">User</a></li>
          <li sec:authorize="isAuthenticated()"><a th:href="@{/logout}">Logout</a></li>
          <!-- <li id="logged-in-info">
						<form method="post" th:action="@{/logout}" >
							<span>Hello</span> <a th:href="@{registration/{id}(id=${registration.firstName})}"></a>
						</form>
					</li> -->
        </ul>
      </div>
    </div>
  </nav>
  <br>
  <br>
  <div id="container1">
    <h3>Welcome to the Carolina Fintech Hub Blog.</h3>
    <h5>All Posts.</h5>
    </div>
<!--    <div th:each="post : ${listPosts}">-->
<!--      <div class="card">-->
<!--          <div class="card-header">-->
<!--              <p>Created on: <span th:text="${post.date}"></span></p>-->
<!--          </div>-->
<!--          <div class="card-body">-->
<!--              <h5 class="card-title">-->
<!--                  <a href="/" th:text="${post.title}" th:href="@{/posts/{id}(id=${post.id})}"></a>-->
<!--              </h5>-->
<!--              <p class="card-text" th:text="${post.content}"></p>-->
<!--              <a th:href="@{'/post/' + ${post.id} + '/update' }" class="btn btn-primary">Update</a>-->
<!--              <a th:href="@{/deletePost/{id}(id=${post.id})}" class="btn btn-danger">Delete</a>-->
<!--          </div>-->
<!--      </div>-->
<!--  </div>-->

    <div th:if="${param.success}" class="alert alert-info" id="messages">You have successfully logged in.</div>
    <div th:if="${param.logout}" class="alert alert-info" id="messages">You have successfully logged out.</div>
    <div class="alert delete-alert" th:if="${param.deleted}">Post has been successfully deleted</div>
    <div class="container my-2 post-container">
      <a sec:authorize="isAuthenticated()" th:href="@{/post/new}" class="btn btn-primary btn-sm mb-3"
         id="addpostbutton"> Add Post </a>
    <br>

    <table border="1" class="table table-striped table-responsive-md">
      <thead>
      <tr>
        <th>
          <a th:href="@{'/page/' + ${currentPage} + '?sortField=title&sortDir=' + ${reverseSortDir}}">
            Post Title
          </a>
        </th>
        <th><a th:href="@{'/page/' + ${currentPage} + '?sortField=date&sortDir=' + ${reverseSortDir}}">
          Time Posted
        </a></th>
        <th>
          Post Content
        </th>
        <th>Actions</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="post : ${posts}">
        <td>
          <a id="postname" th:text="${post.title}"
             th:href="@{/post/view/{id}(id=${post.id})}">
          </a>
        </td>
        <td th:text="${post.date}"></td>
        <td th:text="${post.content}"></td>
        <td>
          <a th:href="@{/post/{id}/update(id=${post.id})}" class="btn btn-primary">Edit</a>
          <a th:href="@{/post/{id}/delete(id=${post.id})}" class="btn btn-danger">Delete</a>
        </td>
      </tr>
      </tbody>
    </table>

    <div th:if = "${totalPages > 1}">
      <div class="row col-sm-10">
        <div class="col-sm-2">
          Total Rows: [[${totalItems}]]
        </div>
        <div class="col-sm-1">
                <span th:each="i: ${#numbers.sequence(1, totalPages)}">
                    <a th:if="${currentPage != i}" th:href="@{'/page/' + ${i}
                    + '?sortField=' + ${sortField} + '&sortDir=' + ${sortDir}}">[[${i}]]</a>
                    <span th:unless="${currentPage != i}">[[${i}]]</span> &nbsp; &nbsp;
                </span>
        </div>
        <div class="col-sm-1">
          <a th:if="${currentPage < totalPages}" th:href="@{'/page/' + ${currentPage + 1}
                 + '?sortField=' + ${sortField} + '&sortDir=' + ${sortDir}}">Next</a>
          <span th:unless="${currentPage < totalPages}">Next</span>
        </div>
        <div class="col-sm-1">
          <a th:if="${currentPage < totalPages}" th:href="@{'/page/' + ${totalPages}
                 + '?sortField=' + ${sortField} + '&sortDir=' + ${sortDir}}">Last</a>
          <span th:unless="${currentPage < totalPages}">Last</span>
        </div>
      </div>
    </div>
  </div>
  <footer th:fragment="site-footer">
    &copy; Carolina Fintech Hub Blog.
  </footer>
</body>
</html>